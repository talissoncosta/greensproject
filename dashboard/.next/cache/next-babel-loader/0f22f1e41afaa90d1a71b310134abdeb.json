{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime-corejs2/regenerator\";\nimport _extends from \"@babel/runtime-corejs2/helpers/esm/extends\";\nvar _jsxFileName = \"/home/tcostaz1/Documentos/DEV/fullstack-challenge-06/dashboard/components/Upload.js\";\nvar __jsx = React.createElement;\nimport React, { useCallback, useState } from 'react';\nimport Snackbar from '@material-ui/core/Snackbar';\nimport { Container, Paper, Button, InputBase, FormGroup, Backdrop, CircularProgress } from '@material-ui/core';\nimport { useDropzone } from 'react-dropzone';\nimport CloudUploadIcon from '@material-ui/icons/CloudUpload';\nimport CheckCircleOutlineIcon from '@material-ui/icons/CheckCircleOutline';\nimport MuiAlert from '@material-ui/lab/Alert';\nimport { makeStyles } from '@material-ui/core/styles';\nimport { post } from '../services/api';\n\nfunction Alert(props) {\n  return __jsx(MuiAlert, _extends({\n    elevation: 6,\n    variant: \"filled\"\n  }, props, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 12\n    },\n    __self: this\n  }));\n}\n\nvar inputStyle = {\n  padding: '100px',\n  cursor: 'pointer'\n};\nvar styleForm = {\n  padding: '10px',\n  margin: 'auto',\n  alignContent: 'center'\n};\nvar stylePaper = {\n  flex: 1,\n  flexDirection: 'row',\n  cursor: 'pointer',\n  padding: '10px',\n  margin: 'auto',\n  alignContent: 'center'\n};\nvar styleInput = {\n  display: 'flex',\n  alignItems: 'center',\n  justifyContent: 'center'\n};\nvar styleBack = {\n  zIndex: 9999,\n  color: '#fff'\n};\nvar useStyles = makeStyles(function (theme) {\n  return {\n    button: {\n      margin: theme.spacing(1)\n    }\n  };\n});\nexport default function Upload(_ref) {\n  var updateTable = _ref.updateTable;\n\n  var _useState = useState(false),\n      openError = _useState[0],\n      setOpenError = _useState[1];\n\n  var _useState2 = useState(false),\n      openSuccess = _useState2[0],\n      setOpenSuccess = _useState2[1];\n\n  var _useState3 = useState(''),\n      fileName = _useState3[0],\n      setFileName = _useState3[1];\n\n  var _useState4 = useState([]),\n      contentFile = _useState4[0],\n      setContentFile = _useState4[1];\n\n  var _useState5 = useState(false),\n      openBackdrop = _useState5[0],\n      setOpenBackdrop = _useState5[1];\n\n  var _useState6 = useState(\"Failed to upload file!\"),\n      contentError = _useState6[0],\n      setContentError = _useState6[1];\n\n  var _useState7 = useState(\"File upload successfully!\"),\n      contentSuccess = _useState7[0],\n      setContentSuccess = _useState7[1];\n\n  var classes = useStyles();\n\n  var uploadProducts = function uploadProducts() {\n    var response;\n    return _regeneratorRuntime.async(function uploadProducts$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            handleToggleBackdrop();\n            _context.next = 3;\n            return _regeneratorRuntime.awrap(post('/products', contentFile));\n\n          case 3:\n            response = _context.sent;\n\n            if (response.success) {\n              setOpenSuccess(true);\n              updateTable();\n              setContentFile([]);\n            } else {\n              setOpenError(true);\n            }\n\n            setFileName('');\n            handleCloseBackdrop();\n\n          case 7:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    });\n  };\n\n  var handleCloseBackdrop = function handleCloseBackdrop() {\n    setOpenBackdrop(false);\n  };\n\n  var handleToggleBackdrop = function handleToggleBackdrop() {\n    setOpenBackdrop(!openBackdrop);\n  };\n\n  var handleCloseSuccess = function handleCloseSuccess(event, reason) {\n    if (reason === 'clickaway') {\n      return;\n    }\n\n    setOpenSuccess(false);\n  };\n\n  var handleCloseError = function handleCloseError(event, reason) {\n    if (reason === 'clickaway') {\n      return;\n    }\n\n    setOpenError(false);\n  };\n\n  var onDrop = useCallback(function (acceptedFiles) {\n    acceptedFiles.forEach(function (file) {\n      if (file.type != 'application/json') {\n        setContentError(\"Failed to upload file! The selected file is not a JSON!\");\n        setOpenError(true);\n        return;\n      }\n\n      setFileName(file.name);\n      var reader = new FileReader();\n\n      reader.onabort = function () {\n        setContentError('File reading was aborted!');\n        setOpenError(true);\n      };\n\n      reader.onerror = function () {\n        setContentError('File reading has failed!');\n        setOpenError(true);\n      };\n\n      reader.onload = function () {\n        var binaryStr = reader.result;\n        setContentFile(binaryStr);\n      };\n\n      reader.readAsText(file);\n    });\n  }, []);\n\n  var _useDropzone = useDropzone({\n    onDrop: onDrop\n  }),\n      getRootProps = _useDropzone.getRootProps,\n      getInputProps = _useDropzone.getInputProps,\n      isDragActive = _useDropzone.isDragActive;\n\n  return __jsx(Container, {\n    styles: inputStyle,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 125\n    },\n    __self: this\n  }, __jsx(FormGroup, {\n    style: styleForm,\n    className: \"App\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 127\n    },\n    __self: this\n  }, __jsx(\"input\", {\n    type: \"file\",\n    name: \"file-5[]\",\n    id: \"file-5\",\n    className: \"inputfile inputfile-4\",\n    hidden: true,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 128\n    },\n    __self: this\n  }), __jsx(Paper, _extends({\n    style: stylePaper\n  }, getRootProps(), {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 135\n    },\n    __self: this\n  }), __jsx(Container, {\n    style: styleInput,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 136\n    },\n    __self: this\n  }, __jsx(\"input\", _extends({\n    style: styleInput\n  }, getInputProps(), {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 137\n    },\n    __self: this\n  })), __jsx(CloudUploadIcon, {\n    style: {\n      fontSize: 100\n    },\n    color: \"primary\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 138\n    },\n    __self: this\n  })), fileName ? __jsx(Container, {\n    style: {\n      fontSize: 20,\n      textAlign: 'center'\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 142\n    },\n    __self: this\n  }, __jsx(CheckCircleOutlineIcon, {\n    style: {\n      fontSize: 20,\n      color: 'green'\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 143\n    },\n    __self: this\n  }), \"  \", fileName) : \"\", __jsx(Container, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 147\n    },\n    __self: this\n  }, isDragActive ? __jsx(\"p\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 150\n    },\n    __self: this\n  }, \"Drop the files here ...\") : __jsx(\"p\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 151\n    },\n    __self: this\n  }, \"Drag 'n' drop or click to select your JSON file\"))), fileName ? __jsx(Container, {\n    style: {\n      textAlign: 'center'\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 158\n    },\n    __self: this\n  }, __jsx(Button, {\n    variant: \"contained\",\n    color: \"primary\",\n    className: classes.button,\n    onClick: function onClick() {\n      return uploadProducts();\n    },\n    startIcon: __jsx(CloudUploadIcon, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 164\n      },\n      __self: this\n    }),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 159\n    },\n    __self: this\n  }, \"Upload\")) : \"\"), __jsx(Snackbar, {\n    open: openError,\n    autoHideDuration: 3000,\n    onClose: handleCloseError,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 172\n    },\n    __self: this\n  }, __jsx(Alert, {\n    severity: \"error\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 173\n    },\n    __self: this\n  }, contentError)), __jsx(Snackbar, {\n    open: openSuccess,\n    autoHideDuration: 3000,\n    onClose: handleCloseSuccess,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 178\n    },\n    __self: this\n  }, __jsx(Alert, {\n    severity: \"success\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 179\n    },\n    __self: this\n  }, contentSuccess)), __jsx(Backdrop, {\n    style: styleBack,\n    open: openBackdrop,\n    onClick: handleCloseBackdrop,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 183\n    },\n    __self: this\n  }, __jsx(CircularProgress, {\n    color: \"inherit\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 184\n    },\n    __self: this\n  })));\n}\n;","map":{"version":3,"sources":["/home/tcostaz1/Documentos/DEV/fullstack-challenge-06/dashboard/components/Upload.js"],"names":["React","useCallback","useState","Snackbar","Container","Paper","Button","InputBase","FormGroup","Backdrop","CircularProgress","useDropzone","CloudUploadIcon","CheckCircleOutlineIcon","MuiAlert","makeStyles","post","Alert","props","inputStyle","padding","cursor","styleForm","margin","alignContent","stylePaper","flex","flexDirection","styleInput","display","alignItems","justifyContent","styleBack","zIndex","color","useStyles","theme","button","spacing","Upload","updateTable","openError","setOpenError","openSuccess","setOpenSuccess","fileName","setFileName","contentFile","setContentFile","openBackdrop","setOpenBackdrop","contentError","setContentError","contentSuccess","setContentSuccess","classes","uploadProducts","handleToggleBackdrop","response","success","handleCloseBackdrop","handleCloseSuccess","event","reason","handleCloseError","onDrop","acceptedFiles","forEach","file","type","name","reader","FileReader","onabort","onerror","onload","binaryStr","result","readAsText","getRootProps","getInputProps","isDragActive","fontSize","textAlign"],"mappings":"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","sourcesContent":["import React, {useCallback,useState} from 'react'\nimport Snackbar from '@material-ui/core/Snackbar';\nimport {Container,Paper,Button,InputBase,FormGroup,Backdrop,CircularProgress} from '@material-ui/core';\nimport {useDropzone} from 'react-dropzone'\nimport CloudUploadIcon from '@material-ui/icons/CloudUpload';\nimport CheckCircleOutlineIcon from '@material-ui/icons/CheckCircleOutline';\nimport MuiAlert from '@material-ui/lab/Alert';\nimport { makeStyles } from '@material-ui/core/styles';\nimport {post} from '../services/api'\n\nfunction Alert(props) {\n  return <MuiAlert elevation={6} variant=\"filled\" {...props} />;\n}\nconst inputStyle = {\n\n    padding: '100px',\n    cursor: 'pointer'\n\n}\n\nconst styleForm = {\n    padding: '10px',\n    margin: 'auto',\n    alignContent: 'center',\n}\nconst stylePaper = {\n    flex:1,\n    flexDirection: 'row',\n    cursor: 'pointer',\n    padding: '10px',\n    margin: 'auto',\n    alignContent: 'center'\n    \n}\nconst styleInput = {\n    display: 'flex',\n    alignItems: 'center',\n    justifyContent: 'center'\n}\nconst styleBack = {\n    zIndex: 9999,\n    color: '#fff'\n}\nconst useStyles = makeStyles(theme => ({\n    button: {\n        margin: theme.spacing(1),\n    },\n}));\n\nexport default function Upload({updateTable}){\n\n    const [openError, setOpenError] = useState(false);\n    const [openSuccess, setOpenSuccess] = useState(false);\n    const [fileName, setFileName] = useState('');\n    const [contentFile, setContentFile] = useState([]);\n    const [openBackdrop, setOpenBackdrop] = useState(false);\n    const [contentError, setContentError] = useState(\"Failed to upload file!\");\n    const [contentSuccess, setContentSuccess] = useState(\"File upload successfully!\");\n    const classes = useStyles();\n\n    const uploadProducts = async () => {\n        handleToggleBackdrop();\n        let response = await post('/products',contentFile);\n\n        if(response.success){\n            setOpenSuccess(true);\n            updateTable();\n            setContentFile([]);\n        }else{\n            setOpenError(true);\n        }\n        setFileName('');\n        handleCloseBackdrop();\n\n    };\n    const handleCloseBackdrop = () => {\n        setOpenBackdrop(false);\n    };\n    const handleToggleBackdrop = () => {\n        setOpenBackdrop(!openBackdrop);\n    };\n    const handleCloseSuccess = (event, reason) => {\n        if (reason === 'clickaway') {\n            return;\n        }\n\n        setOpenSuccess(false);\n    };\n    const handleCloseError = (event, reason) => {\n        if (reason === 'clickaway') {\n            return;\n        }\n\n        setOpenError(false);\n    };\n    const onDrop = useCallback((acceptedFiles) => {\n        acceptedFiles.forEach((file) => {\n            if(file.type != 'application/json'){\n                setContentError(\"Failed to upload file! The selected file is not a JSON!\")\n                setOpenError(true);\n                return;\n            }\n            setFileName(file.name)\n            const reader = new FileReader()\n\n            reader.onabort = () => {\n                setContentError('File reading was aborted!');\n                setOpenError(true);\n            }\n            reader.onerror = () => {\n                setContentError('File reading has failed!');\n                setOpenError(true);\n            }\n            reader.onload = () => {\n                const binaryStr = reader.result;\n                setContentFile(binaryStr);\n            }\n            reader.readAsText(file)\n        })\n\n    }, [])\n    const {getRootProps, getInputProps,isDragActive} = useDropzone({onDrop})\n\n    return (\n        <Container styles={inputStyle}>\n\n            <FormGroup style={styleForm} className=\"App\">\n                        <input\n                type=\"file\"\n                name=\"file-5[]\"\n                id=\"file-5\"\n                className=\"inputfile inputfile-4\"\n                hidden\n            />\n            <Paper style={stylePaper} {...getRootProps()}>\n                <Container style={styleInput}>\n                <input style={styleInput}{...getInputProps()} />\n                <CloudUploadIcon  style={{ fontSize: 100}}  color=\"primary\" />\n                </Container>\n                {\n                    fileName ?\n                    <Container style={{ fontSize: 20,textAlign:'center'}}>\n                        <CheckCircleOutlineIcon style={{ fontSize: 20,color:'green'}} />  {fileName}\n                    </Container> : \"\"\n                }\n\n                <Container>\n                {\n                    isDragActive ?\n                    <p>Drop the files here ...</p> :\n                    <p>Drag 'n' drop or click to select your JSON file</p>\n                }\n                </Container>\n\n            </Paper>\n                {\n                    fileName ?\n                    <Container style={{textAlign:'center'}}>\n                        <Button\n                            variant=\"contained\"\n                            color=\"primary\"\n                            className={classes.button}\n                            onClick={() => uploadProducts()}\n                            startIcon={<CloudUploadIcon />}\n                        >\n                            Upload\n                        </Button>\n                    </Container>  : \"\"\n                } \n            </FormGroup>\n\n            <Snackbar open={openError} autoHideDuration={3000} onClose={handleCloseError} >\n                <Alert  severity=\"error\">\n                    {contentError}\n                </Alert>\n            </Snackbar>\n\n            <Snackbar open={openSuccess} autoHideDuration={3000} onClose={handleCloseSuccess} >\n                <Alert  severity=\"success\">\n                    {contentSuccess}\n                </Alert>\n            </Snackbar>\n            <Backdrop style={styleBack} open={openBackdrop} onClick={handleCloseBackdrop}>\n                <CircularProgress color=\"inherit\" />\n            </Backdrop>\n        </Container>\n\n    )\n\n};\n  \n  \n"]},"metadata":{},"sourceType":"module"}